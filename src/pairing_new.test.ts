import Pairing from "./pairing_new";
import Fq12 from "./fq12";
import Fq6 from "./fq6";
import Fq2 from "./fq2";
import Fq from "./fq";
import G1 from "./g1_new";
import G2 from "./g2_new";


describe('test pairing functions', function() {

    //Fq12 result after final_exponentiation

    //c0: c0: c0:
    //798502083397251921633833674883831104730682408543675020367286750497807698645
    //c0: c0: c1:
    //20793674778978652694944268622468059656139754448735949818355501586028955257569
    //c0: c1: c0:
    //19048478524633283498085811054381399442903474179854423089240633507472524150262
    //c0: c1: c1:
    //15038731096124620452385470562243005872807692220833222100737078380290179293601
    //c0: c2: c0:
    //19681044767574525412286316344330609819205364432495350388091397098350158009791
    //c0: c2: c1:
    //14169609043629130412242917837138631876517067323018367346926035791950997191660
    //c1: c0: c0:
    //21681460614944590471230154167872844780267038250831055610345302175827879148819
    //c1: c0: c1:
    //8747515195756416269723830997182137311552961765373288911025484618924826387952
    //c1: c1: c0:
    //14855910687706175046573301839761345733585599107938739358093378151700479377612
    //c1: c1: c1:
    //8903458072238520772063941873669153241276993002477451201620137453911786119461
    //c1: c2: c0:
    //12657732548725281370731292049617675660830024822575316295880259464449340428763
    //c1: c2: c1:
    //6884837954578062278521836969300104051613900678416646060390403430109502310478

  it('Test final exponentiation', function() {
    console.log("test final exponentiation ");

    let second = new Fq12(
        new Fq6(
            new Fq2(
                new Fq(21227010742668523973779795892080484478413631586992185774992397774453111499562n),
                new Fq(19226519837628619696197361438039192285186559783794253066594478201300567625581n)
            ),
            new Fq2(
                new Fq(7782287104470559324105132304997884557026788032401170325684944465605236395051n),
                new Fq(19110893883636139580674900407653400921517208489522902969760806789675732237443n)
            ),
            new Fq2(
                new Fq(13373558987747729767106266411641782708520066622224553970810646960119770906482n),
                new Fq(8239735462772116299759198943303716067067211972951745657386023141164294230159n),
            )
        ),

        new Fq6(
            new Fq2(
                new Fq(19723498938913580838527010796995565664940964702558430218792533379614170175584n),
                new Fq(19198937630784884904531985231983944570953927007639024736778645015422755148596n)
            ),
            new Fq2(
                new Fq(318460156404207635097638769497134177093016410663420631112968904066667788855n),
                new Fq(5811915892240812086868837101820778755877273314773348243459728092795714036353n)
            ),
            new Fq2(
                new Fq(20555792769679092785671034318258460903890555657119752069678898280830359015944n),
                new Fq(3839526312266986973044379943534614883360461121168709130959429802008624145960n),
            )
        )
    );

    let res = Pairing.final_exponentiation(second);

    console.log("The final exponentiation result is:");
    console.log(res.c0.c0.c0.toBigInt());
    console.log(res.c0.c0.c1.toBigInt());
    console.log(res.c0.c1.c0.toBigInt());
    console.log(res.c0.c1.c1.toBigInt());
    console.log(res.c0.c2.c0.toBigInt());
    console.log(res.c0.c2.c1.toBigInt());
    console.log(res.c1.c0.c0.toBigInt());
    console.log(res.c1.c0.c1.toBigInt());
    console.log(res.c1.c1.c0.toBigInt());
    console.log(res.c1.c1.c1.toBigInt());
    console.log(res.c1.c2.c0.toBigInt());
    console.log(res.c1.c2.c1.toBigInt());

  });

  it('Test final exponentiation', function() {
    console.log("test final exponentiation ");

    let second = new Fq12(
        new Fq6(
            new Fq2(
                new Fq(21227010742668523973779795892080484478413631586992185774992397774453111499562n),
                new Fq(19226519837628619696197361438039192285186559783794253066594478201300567625581n)
            ),
            new Fq2(
                new Fq(7782287104470559324105132304997884557026788032401170325684944465605236395051n),
                new Fq(19110893883636139580674900407653400921517208489522902969760806789675732237443n)
            ),
            new Fq2(
                new Fq(13373558987747729767106266411641782708520066622224553970810646960119770906482n),
                new Fq(8239735462772116299759198943303716067067211972951745657386023141164294230159n),
            )
        ),

        new Fq6(
            new Fq2(
                new Fq(19723498938913580838527010796995565664940964702558430218792533379614170175584n),
                new Fq(19198937630784884904531985231983944570953927007639024736778645015422755148596n)
            ),
            new Fq2(
                new Fq(318460156404207635097638769497134177093016410663420631112968904066667788855n),
                new Fq(5811915892240812086868837101820778755877273314773348243459728092795714036353n)
            ),
            new Fq2(
                new Fq(20555792769679092785671034318258460903890555657119752069678898280830359015944n),
                new Fq(3839526312266986973044379943534614883360461121168709130959429802008624145960n),
            )
        )
    );
    
    let g1_generator = G1.generator();
    let g1_generator_affine = g1_generator.to_affine();

    let g2_generator = G2.generator();
    let g2_generator_affine = g2_generator.to_affine();

    //let miller_result = Pairing.miller_loop(g2_generator_affine);
    let res = Pairing.final_exponentiation(second);

    console.log("The final exponentiation result is:");
    console.log(res.c0.c0.c0.toBigInt());
    console.log(res.c0.c0.c1.toBigInt());
    console.log(res.c0.c1.c0.toBigInt());
    console.log(res.c0.c1.c1.toBigInt());
    console.log(res.c0.c2.c0.toBigInt());
    console.log(res.c0.c2.c1.toBigInt());
    console.log(res.c1.c0.c0.toBigInt());
    console.log(res.c1.c0.c1.toBigInt());
    console.log(res.c1.c1.c0.toBigInt());
    console.log(res.c1.c1.c1.toBigInt());
    console.log(res.c1.c2.c0.toBigInt());
    console.log(res.c1.c2.c1.toBigInt());

  });

/*g2_affine_3g
G2 x c0
2725019753478801796453339367788033689375851816420509565303521482350756874229
G2 x c1
7273165102799931111715871471550377909735733521218303035754523677688038059653
G2 y c0
2512659008974376214222774206987427162027254181373325676825515531566330959255
G2 y c1
957874124722006818841961785324909313781880061366718538693995380805373202866
G2 z c0
0
G2 z c1
0
g2_2g
G2 x c0
18064657650266314310872833882734510304469342224960895762840452673540398385663
G2 x c1
15767209469806156760211170373387620603270210844572625444480773861832148323813
G2 y c0
18350387758438165722514006433324734852126505429007818091896560652419680779208
G2 y c1
2361120538552305763462588552289584032113666280040005078430227626567900900889
G2 z c0
11295011439305748432050915375304030887315222387144299555868531462511479541127
G2 z c1
21586188435259680269345972498488110271568572496353012928929868286300284796401
addition result
G2 x c0
14544768148792632680073221983566693239583282104557296657848306123566393475730
G2 x c1
15034324394469490987779704591448025941722072015306291430099460905795412688577
G2 y c0
11002011155701785813972642690498120535862192909530050003961781729574140785553
G2 y c1
10463967624402083525436831344787392148296280284977976166619878361459662805605
G2 z c0
8863921422321631853541600922641661429758378788881107427311426765831451334272
G2 z c1
5034616795582565734225936021994665960773476499030844842075241925330862037999*/

  it('Test g1 g2', function() {
    console.log("Test g1 affine and projective transform");
    let g2_affine_3g = new G2(
        new Fq2(
            new Fq(2725019753478801796453339367788033689375851816420509565303521482350756874229n),
            new Fq(7273165102799931111715871471550377909735733521218303035754523677688038059653n)
        ),
        new Fq2(
            new Fq(2512659008974376214222774206987427162027254181373325676825515531566330959255n),
            new Fq(957874124722006818841961785324909313781880061366718538693995380805373202866n)
        ),
        new Fq2(
            new Fq(0n),
            new Fq(0n)
        )
    )

    let g2_2g = new G2(
        new Fq2(
            new Fq(18064657650266314310872833882734510304469342224960895762840452673540398385663n),
            new Fq(15767209469806156760211170373387620603270210844572625444480773861832148323813n)
        ),
        new Fq2(
            new Fq(18350387758438165722514006433324734852126505429007818091896560652419680779208n),
            new Fq(2361120538552305763462588552289584032113666280040005078430227626567900900889n)
        ),
        new Fq2(
            new Fq(11295011439305748432050915375304030887315222387144299555868531462511479541127n),
            new Fq(21586188435259680269345972498488110271568572496353012928929868286300284796401n)
        )
    )

    let g2_generator = G2.generator();
    let g2_generator_2g = g2_generator.add(g2_generator);
    let g2_generator_3g = g2_generator_2g.add(g2_generator);

    let g2_generator_3g_affine = g2_generator_3g.to_affine();

    console.log(g2_generator_2g.x.c0.toBigInt());
    console.log(g2_generator_2g.x.c1.toBigInt());
    console.log(g2_generator_2g.y.c0.toBigInt());
    console.log(g2_generator_2g.y.c1.toBigInt());
    console.log(g2_generator_2g.z.c0.toBigInt());
    console.log(g2_generator_2g.z.c1.toBigInt());

    console.log(g2_generator_3g_affine.x.c0.toBigInt());
    console.log(g2_generator_3g_affine.x.c1.toBigInt());
    console.log(g2_generator_3g_affine.y.c0.toBigInt());
    console.log(g2_generator_3g_affine.y.c1.toBigInt());
    console.log(g2_generator_3g_affine.z.c0.toBigInt());
    console.log(g2_generator_3g_affine.z.c1.toBigInt());
    
    let addition_result = Pairing.addition_step(g2_2g, g2_affine_3g);

    console.log(addition_result.x.c0.toBigInt());
    console.log(addition_result.x.c1.toBigInt());
    console.log(addition_result.y.c0.toBigInt());
    console.log(addition_result.y.c1.toBigInt());
    console.log(addition_result.z.c0.toBigInt());
    console.log(addition_result.z.c1.toBigInt());

  });

});